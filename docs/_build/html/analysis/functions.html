
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Functions &#8212; Proteins  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Main/global code" href="main.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="functions">
<h1>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="simulation">
<h2>Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Priority</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Difficulty</p></th>
<th class="head"><p>Synopsis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>+</cite></p></td>
<td><p>prepare</p></td>
<td><p>Simple</p></td>
<td><p>A function called before each step. Zeroes a lot of variables and recalculates many auxilary variables, like ‘v’ or ‘vxv’.</p></td>
</tr>
<tr class="row-odd"><td><p><cite>+</cite></p></td>
<td><p>update_verlet_list</p></td>
<td><p>Hard</p></td>
<td><p>Updates the verlet list, but it’s hard to say what actually is updated there.</p></td>
</tr>
<tr class="row-even"><td><p><cite>+</cite></p></td>
<td><p>evalgo</p></td>
<td><p>Hard</p></td>
<td><p>Computes the energy and force of the Go model. The interactions include:
- harmonic between residues i and i + 1
- standard L-J between native contacts
- repulsive L-J between residues i and i + 2
- repulsive L-J between residues that aren’t in a native contact but are close to each other.
- some weird stuff with ss bonds.</p></td>
</tr>
<tr class="row-odd"><td><p><cite>+?</cite></p></td>
<td><p>evalcpot</p></td>
<td><p>Hard</p></td>
<td><p>Calculates energy and force of the custom potential (???)</p></td>
</tr>
<tr class="row-even"><td><p><cite>+</cite></p></td>
<td><p>evalangles</p></td>
<td><p>Medium</p></td>
<td><p>Computes the energy and force related to bond (i-1, i, i+1) and dihedral (i-2, i-1, i, i+1) angles.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>evalimproper</p></td>
<td><p>Medium</p></td>
<td><p>Calculates energy and force of the PID potential.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>evalwall</p></td>
<td><p>Medium</p></td>
<td><p>Computes the energy and forces related to wall interactions.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>eval_chirality</p></td>
<td><p>Simple</p></td>
<td><p>Computes the energy and forces arising from chirality potential.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>afm</p></td>
<td><p>Simple</p></td>
<td><p>Applies constant AFM force on the first and last residue.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>vafm</p></td>
<td><p>Medium</p></td>
<td><p>Applies AFM force on the first and last residue by simulating a harmonic spring that moves with constant velocity. But also does some logic with walls (???)</p></td>
</tr>
<tr class="row-even"><td><p><cite>+</cite></p></td>
<td><p>predct</p></td>
<td><p>VSimple</p></td>
<td><p>Predictor step from the predictor-corrector method.</p></td>
</tr>
<tr class="row-odd"><td><p><cite>+</cite></p></td>
<td><p>corr</p></td>
<td><p>VSimple</p></td>
<td><p>Corrector step from the predictor-corrector method.</p></td>
</tr>
<tr class="row-even"><td><p><cite>+</cite></p></td>
<td><p>lang</p></td>
<td><p>VSimple</p></td>
<td><p>Adds langevin noise and damping (which simulates the effect of implicit solvent).</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>lang_mass</p></td>
<td><p>VSimple</p></td>
<td><p>lang, but accounts for different masses of residues.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="math">
<h2>Math<a class="headerlink" href="#math" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Priority</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Difficulty</p></th>
<th class="head"><p>Synopsis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>+</cite></p></td>
<td><p>dihedral</p></td>
<td><p>Simple</p></td>
<td><p>Calculates dihedral angle (for a given set of 4 vectors).</p></td>
</tr>
<tr class="row-odd"><td><p><cite>+</cite></p></td>
<td><p>bondangle</p></td>
<td><p>Very simple</p></td>
<td><p>Calculates the bond angle (for a given set of 4 vectors).</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>countpid</p></td>
<td><p>Simple</p></td>
<td><p>Computes phi (angle used in PID) for a given pair of residues. Used only in ‘print_map’ -&gt; ‘compute_details’.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>norma</p></td>
<td><p>VSimple</p></td>
<td><p>Takes a 3x3 matrix and normalizes its columns. Used only in kabsch.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>pvector</p></td>
<td><p>VSimple</p></td>
<td><p>Given two 3D vectors, calculates cross product and its norm.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>jacobi</p></td>
<td><p>Medium</p></td>
<td><p>Given a 3x3 symmetric matrix it finds its eigen(values|vectors).</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>eigsrt</p></td>
<td><p>VSimple</p></td>
<td><p>Given the output of jacobi it sorts eigenvectors in descending order by their lengths.</p></td>
</tr>
<tr class="row-odd"><td><p><cite>+</cite></p></td>
<td><p>ran2</p></td>
<td><p>Simple</p></td>
<td><p>Random number generator.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="input">
<h2>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Priority</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Difficulty</p></th>
<th class="head"><p>Synopsis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p>load_allatom</p></td>
<td><p>Simple</p></td>
<td><p>Part of ‘compute_contact_map’. Given the PDB file, it reads the native positions of atoms in the protein.</p></td>
</tr>
<tr class="row-odd"><td><p><cite>+</cite></p></td>
<td><p>load_protein</p></td>
<td><p>Hard</p></td>
<td><p>Loads the native conformation and SS bonds from the PDB file. Big part of it runs only when ‘lunwrap’ is true (unwrapping coordinates arising from periodic boundary conditions).</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>load_cmap</p></td>
<td><p>VSimple</p></td>
<td><p>Loads native contacts directly from a .map file (also dihedral and bond angles).</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>load_sequence</p></td>
<td><p>Simple</p></td>
<td><p>Loads a sequence of amino acids to simulate (for disordered proteins).</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>load_paramfile</p></td>
<td><p>Simple</p></td>
<td><p>Loads various parameters from ‘paramfile’ (example3 has ‘parameters.txt’).</p></td>
</tr>
<tr class="row-odd"><td><p><cite>+</cite></p></td>
<td><p>compute_native_angles</p></td>
<td><p>VSimple</p></td>
<td><p>Computes dihedral and bond angles for native conformation.</p></td>
</tr>
<tr class="row-even"><td><p><cite>+</cite></p></td>
<td><p>gopotential</p></td>
<td><p>Simple</p></td>
<td><p>If ‘lpdb’ is true, it calculates the sigmas of L-J potential for all contacts (the meaning of sigmas - p. 9 in the paper).</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>model_chirality</p></td>
<td><p>VSimple</p></td>
<td><p>Calculates the chiralities for the native structure.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>amino_acid_mass</p></td>
<td><p>VSimple</p></td>
<td><p>Computes masses of residues relative to the mass of the entire protein.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>compute_contact_map</p></td>
<td><p>Medium</p></td>
<td><p>Computes native contacts from a PDB file based on the positions of individual atoms in the amino-acids.</p></td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>compute_cmap</p></td>
<td><p>Simple</p></td>
<td><p>Simpler alternative to ‘compute_contact_map’. It defines a contact between residues by the cut-off on the distance between C-alpha atoms.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>assign_VdW_radius</p></td>
<td><p>Medium</p></td>
<td><p>Part of ‘compute_contact_map’. It assigns the Van der Waals radius to all atoms in the amino-acids in the chains. Also performs some checks.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>displace</p></td>
<td><p>Simple</p></td>
<td><p>Displaces one specified pair of chains away from each other by a given distance.</p></td>
</tr>
<tr class="row-odd"><td><p><cite>+</cite></p></td>
<td><p>confstart</p></td>
<td><p>Medium</p></td>
<td><p>Generates the starting conformation (it’s supposed to be a self-avoiding random walk).</p></td>
</tr>
<tr class="row-even"><td><p><cite>+</cite></p></td>
<td><p>intvel3d</p></td>
<td><p>Simple</p></td>
<td><p>Assigns initial velocities to the pseudoatoms.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="stats">
<h2>Stats<a class="headerlink" href="#stats" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Priority</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Difficulty</p></th>
<th class="head"><p>Synopsis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>+</cite></p></td>
<td><p>gyration</p></td>
<td><p>VSimple</p></td>
<td><p>Computes radius of gyration of the protein, which is the standard deviation of distances from residues to the center of mass.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>cgyration</p></td>
<td><p>Medium</p></td>
<td><p>Computes various statistics - the radii of gyration for all chains, also W (asphericity parameter, whatever that is). Also finds knots.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>kmt</p></td>
<td><p>Hard</p></td>
<td><p>Used only in ‘cgyration’. Finds the beginning and end of a knot in a chain. Possibly some knot theory is needed to understand it.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>kabsch</p></td>
<td><p>Medium</p></td>
<td><p>Given two sequences of 3D vectors of equal length, finds a rotation + translation that minimizes the root mean sqared deviation between them. See ‘Kabsch algorithm’ on Wikipedia.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>compute_rmsd</p></td>
<td><p>VSimple</p></td>
<td><p>Calls ‘kabsch’ on the positions of residues after simulation ends and their original positions.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Priority</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Difficulty</p></th>
<th class="head"><p>Synopsis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p>print_restart</p></td>
<td><p>VSimple</p></td>
<td><p>Prints the restart file.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>print_conformation</p></td>
<td><p>Medium</p></td>
<td><p>Prints the conformation in the PDB format.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>print_conf_xyz</p></td>
<td><p>VSimple</p></td>
<td><p>Prints the conformation in the XYZ format.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>print_cmap</p></td>
<td><p>VSimple</p></td>
<td><p>If ‘lwritego’ is true, no simulations are performed and this function prints the contact map.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>print_map</p></td>
<td><p>Medium</p></td>
<td><p>Prints a contact map file that contains all the contacts after the simulation (optionally adds some details about angles).</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>compute_details</p></td>
<td><p>Simple</p></td>
<td><p>Given two residues, computes some angles between them. Used in ‘print_map’ when ‘ldet’ is true.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="walls">
<h2>Walls<a class="headerlink" href="#walls" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Priority</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Difficulty</p></th>
<th class="head"><p>Synopsis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p>connect_to_wal_one_by_one</p></td>
<td><p>???</p></td>
<td><p>???</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>connect_to_wal</p></td>
<td><p>???</p></td>
<td><p>???</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>make_fcc</p></td>
<td><p>Simple</p></td>
<td><p>Creates a 2-layer, triangular lattice of beads that form a wall.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="other">
<h2>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Priority</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Difficulty</p></th>
<th class="head"><p>Synopsis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p>sort, sort2</p></td>
<td><p>VSimple</p></td>
<td><p>Just a quicksort (sort2 applies the same permutation to a second array).</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>angeval</p></td>
<td><p>Medium</p></td>
<td><p>Never called. Maybe the older version of evalangles.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>compute_ssbonds</p></td>
<td><p>Simple</p></td>
<td><p>Never called. Probably obsolete.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>build_titin</p></td>
<td><p>Simple</p></td>
<td><p>Used for building titin - a very large protein composed of many protein domains.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>interdomain</p></td>
<td><p>Simple</p></td>
<td><p>Next step for building titin, disables contacts between different domains of titin.</p></td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Proteins</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Project overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Analysis of legacy code</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#incremental-design-and-code-coverage">Incremental design and code coverage</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#fortran-77-source-code-documentation">Fortran 77 source code documentation</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Analysis of legacy code</a><ul>
      <li>Previous: <a href="main.html" title="previous chapter">Main/global code</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, IF PAN, ZPP Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/analysis/functions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>